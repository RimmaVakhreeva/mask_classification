# mask_classification

**Задача** - классифицировать наличие/отсутствие маски.

Для тренировки модели использовались 234516 изображений с масками и 500K изображений без масок.  Было проведено выравнивание лиц.

Для детекции лиц использовалась RetinaFace.

**Эксперименты**

1. Для решения задачи классификации в качестве бэкбона использовалась resnet18, оптимизатор - Adam, функция потерь - BinaryCrossEntropy, количество эпох - 20. Тренировочные и тестовые данные были нормализованы.

Результаты: accuracy=0.613, f1=0.0538.

2. backbone - resnet18, оптимизатор - Adam, функция потерь - BinaryCrossEntropy, количество эпох - 20. К тренировочным данным была добавлена аугментация.

Результаты: accuracy=0.687, f1=0.189.

3. backbone - resnet18, оптимизатор - SGD, функция потерь - BinaryCrossEntropy, количество эпох - 20.

Результаты: accuracy=0.713, f1=0.228.

4. backbone - mobilenetv3_large_100, оптимизатор - SGD, функция потерь - BinaryCrossEntropy, количество эпох - 20.

Результаты: accuracy=0.663, f1=0.150.

5. backbone - mobilenetv3_large_100, оптимизатор - SGD, функция потерь - BinaryCrossEntropy, количество эпох - 50. Дополнительно к тренировочным изображениям были добавлены изображения с масками (около 30K).

Результаты: accuracy=0.922, f1=0.435.

6. backbone - mobilenetv3_large_100, оптимизатор - SGD, функция потерь - BinaryCrossEntropy, количество эпох - 50. Была исправлена аугментация тренировочных данных.

Результаты: accuracy=0.96, f1=0.95.

![](stuff/output.gif)
